<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Darts 501 Scorekeeper</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.3/css/bulma.min.css">
    <style>
        .score-log {
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
    <script>
        let totalScore = 501;
        let scoreLog = [];

        // Submit score and update remaining score and log
        function UPME_submitScore() {
            if (this.event_click || (this.event_keyup && this.event_keyup.key === 'Enter')) {
                const scoreInputElement = document.querySelector('.scoreInput');
                const scoreInput = parseInt(scoreInputElement.value);

                if (!isNaN(scoreInput) && scoreInput > 0 && scoreInput <= totalScore) {
                    totalScore -= scoreInput;
                    scoreLog.push(scoreInput);
                    document.querySelector('.UPME.remainingScore').textContent = totalScore;
                    document.querySelector('.UPME.scoreLog').textContent = scoreLog.join(', ');
                    scoreInputElement.value = '';
                } else {
                    alert('Invalid score. Please enter a number between 1 and your current remaining score.');
                    scoreInputElement.value = '';
                }
            }
        }

        // Undo the last scored entry
        function UPME_undoScore() {
            if (this.event_click) {
                const index = parseInt(this.dataset.index);
                totalScore += scoreLog[index];
                scoreLog.splice(index, 1);
                document.querySelector('.UPME.remainingScore').textContent = totalScore;
                document.querySelector('.UPME.scoreLog').textContent = scoreLog.join(', ');
            }
        }

        // Reset the game
        function UPME_resetGame() {
            if (this.event_click) {
                totalScore = 501;
                scoreLog = [];
                document.querySelector('.UPME.remainingScore').textContent = totalScore;
                document.querySelector('.UPME.scoreLog').textContent = '';
            }
        }

        // Update the remaining score display
        function UPME_remainingScore() {
            this.textContent = totalScore;
        }

        // Update the score log display
        function UPME_scoreLog() {
            this.innerHTML = '';
            scoreLog.forEach((score, index) => {
                const logItem = document.createElement('button');
                logItem.className = 'button is-small is-light UPME undoScore';
                logItem.dataset.index = index;
                logItem.textContent = `Undo Scored: ${score}`;
                this.appendChild(logItem);
            });
        }
    </script>
</head>
<body class="UPME">
    <section class="section">
        <div class="container">
            <h1 class="title">Darts 501 Scorekeeper</h1>
            <p class="subtitle">Keep track of your score as you play.</p>

            <!-- Display remaining score -->
            <div class="box">
                <h2 class="title is-4">Remaining Score: <span class="UPME remainingScore">501</span></h2>
            </div>

            <!-- Input for scoring -->
            <div class="field">
                <label class="label">Enter Score</label>
                <div class="control">
                    <input type="number" class="input scoreInput" placeholder="Enter your score">
                </div>
            </div>

            <!-- Submit score button -->
            <div class="field">
                <div class="control">
                    <button class="button is-primary UPME submitScore">Submit Score</button>
                </div>
            </div>

            <!-- Score log -->
            <div class="box score-log">
                <h2 class="title is-5">Score Log</h2>
                <ul class="UPME scoreLog">
                    <!-- Log entries will be dynamically inserted here -->
                </ul>
            </div>

            <!-- Reset button -->
            <div class="field">
                <div class="control">
                    <button class="button is-danger UPME resetGame">Reset Game</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Include the UPME.js library -->
    <script src="upme.js"></script>
</body>
</html>
