<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frogger-like Game</title>
    <script src="upyours.js"></script>
    <style>
        html, body
        {
            width:100%;
            height:100%;
            overflow: hidden;
            background-color: gray;
        }
        .frog
        {
            width:5%;
        }

        .car
        {
            width:10%;
        }

        .flip
        {
            transform: scaleX(-1);
        }
    </style>
    <script>

        let keyHeld = {};
        let keyPress = {};
        let gameWidth = window.innerWidth;
        let gameHeight = window.innerHeight;

        function getCollision(element, selector) 
        {
            const elements = document.querySelectorAll(selector);
            for (let i = 0; i < elements.length; i++) {
                const currentElement = elements[i];
                if (element !== currentElement && isOverlap(element, currentElement)) {
                    return currentElement;
                }
            }
            return false;
        }

        function isOverlap(element1, element2) 
        {
            const rect1 = element1.getBoundingClientRect();
            const rect2 = element2.getBoundingClientRect();
            return (
                rect1.left < rect2.right &&
                rect1.right > rect2.left &&
                rect1.top < rect2.bottom &&
                rect1.bottom > rect2.top
            );
        }

        UPYOURS['html'] = function()
        {
            keyPress={};

            if (this.event_keydown)
            {
                keyHeld[this.event_keydown.key] = true;
                keyPress[this.event_keydown.key] = true;
            }

            if (this.event_keyup)
                keyHeld[this.event_keyup.key] = false;
        }

        UPYOURS['.mover'] = function()
        {
            if (this.mySpeedX === undefined)
            {
                this.mySpeedX =0;
                this.mySpeedY = 0;
                this.myX = 0;
                this.myY = 0;
            }

            this.myX += this.mySpeedX;
            this.myY += this.mySpeedY;
            

            this.style.left = this.myX + 'px';
            this.style.top = this.myY + 'px';
            this.style.position = 'absolute';

            
            if (this.mySpeedX !== 0 || this.mySpeedY !== 0) 
            {
                const angle = Math.atan2(this.mySpeedY, this.mySpeedX) * (180 / Math.PI);
                this.style.transform = `rotate(${angle}deg)`;
            }

            if (this.myY<0)
                this.myY=0;
            if (this.myY>gameHeight)
                this.myY=gameHeight;

        }
        
        UPYOURS['.frog'] = function()
        {
            if (this.didInit === undefined)
            {
                this.didInit = true;
                this.myY = gameHeight - 100;
            }
            this.mySize = this.offsetWidth;

            if (keyPress['ArrowUp'])
            {
                this.mySpeedY = -this.mySize;
            }
            else if (keyPress['ArrowDown'])
            {
                this.mySpeedY = this.mySize;
            }
            else
            {
                this.mySpeedY = 0;
            }

            if (keyPress['ArrowLeft'])
            {
                this.mySpeedX = -this.mySize;
            }
            else if (keyPress['ArrowRight'])
            {
                this.mySpeedX = this.mySize;
            }
            else
            {
                this.mySpeedX = 0;
            }

            if (this.myX < 0)
            {
                this.myX = 0;
            }
            if (this.myX > gameWidth)
            {
                this.myX = gameWidth;
            }
         

        }

        UPYOURS['.car'] = function()
        {
            this.myY = this.myY || Math.random()*this.offsetHeight*5;
            this.mySpeedX = this.mySpeedX || Math.random()*this.offsetWidth*.1 - Math.random()*this.offsetWidth*.1;
            if (this.myX > window.innerWidth)
            {
                this.myX = -100;
            }
            if (this.myX < -100)
            {
                this.myX = window.innerWidth;
            }
            this.myX += this.mySpeedX;

            let otherCar = getCollision(this, '.car');
            if (otherCar)
            {
                if (this.myY<otherCar.myY)
                {
                    this.myY--;
                    otherCar.myY++;
                }
                else
                {
                    this.myY++;
                    otherCar.myY--;
                }
            }

            if (getCollision(this, '.frog'))
            {
                //alert('You lose!');
                window.location.reload();
            }
        }

    </script>
</head>
<body class="UPME theGame">
    <img src="car.png"  class="car mover" />
    <img src="car.png"  class="car mover" />
    <img src="car.png"  class="car mover" />
    <img src="car.png"  class="car mover" />
    <img src="car.png"  class="car mover" />
    <br/><br/><br/>
    
    <img src="frog.png" class="frog mover" />
</body>
</html>
